<!DOCTYPE html>
<html lang="en">
<link rel="stylesheet" href="https://www.w3schools.com/w3css/4/w3.css">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Synthesizer</title>
    <link rel="icon" type="image/x-icon" href="https://cdn-icons-png.flaticon.com/512/727/727244.png">
    <link rel="stylesheet" href="css/genie/navbar.css">
    <link rel="stylesheet" href="css/genie/piano.css">
    <script src="css/genie/input-knobs.js"></script>
    <style>
        .slidecontainer {
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
        }
    </style>
</head>

<body>
    <div class="topnav" id="myTopnav">
        <a href="/" class="active"><b>SynthLab</b> Synth Education</a>
        <a href="/piano">Synthesizer</a>
        <div class="dropdown">
            <button class="dropbtn">Lessons
                <i class="fa fa-caret-down"></i>
            </button>
            <div class="dropdown-content">
                <a href="/vwhLesson">Volume, Waveforms, & Harmonics</a>
                <a href="/ahdsrLesson">AHDSR</a>
                <a href="/distortionLesson">Distortion</a>
                <a href="/tremoloLesson">Tremolo</a>
                <a href="/vibratoLesson">Vibrato</a>
            </div>
        </div>
        <a href="/aboutus">About</a>
        <a href="javascript:void(0);" class="icon" onclick="myFunction()">&#9776;</a>
    </div>
    <div class="container">
        <div class="intro-container">
            <div class="left-container">
                <div class="btn-container" style="border: 1px solid black; padding: 10px;">
                    <div class="vert">
                        <span>Waveform</span>
                        <div class="btn-group">
                            <button data-number="5" class="btn">SemiSinusoid</button>
                            <button data-number="4" class="btn">Sinusoid</button>
                            <button data-number="2" class="btn">Square</button>
                            <button data-number="3" class="btn">Sawtooth</button>
                            <button data-number="1" class="btn">Triangle</button>
                        </div>
                    </div>
                </div>

                <div class="effect-container">
                    <div class="hori">
                        <div class="vert" style="border: 1px solid black; padding: 10px;">
                            <div class="hori">
                                <b>Tremolo</b>
                                <input type="checkbox" class="input-switch" id="tremAct" onclick="tremAct()">
                            </div>
                            <div class="hori">
                                <div class="slidecontainer">
                                    <input type="range" min="0" max="10" value="0" step="1" class="input-knob"
                                        id="tremDepth">
                                    <span class="sliderval" id="range_slider__value">Depth</span>
                                </div>
                                <div class="slidecontainer">
                                    <input type="range" min="3" max="10" value="0" step="1" class="input-knob"
                                        id="tremRate">
                                    <span class="sliderval" id="range_slider__value">Rate</span>
                                </div>
                            </div>
                        </div>
                        <p>

                        </p>
                        <div class="vert" style="border: 1px solid black; padding: 10px;">
                            <div class="hori">
                                <b>Vibrato</b>
                                <input type="checkbox" class="input-switch" id="vibAct" onclick="vibAct()">
                            </div>
                            <div class="hori">
                                <div class="slidecontainer">
                                    <input type="range" min="0" max="10" value="0" step="1" class="input-knob"
                                        id="vibDepth">
                                    <span class="sliderval" id="range_slider__value">Depth</span>
                                </div>
                                <div class="slidecontainer">
                                    <input type="range" min="3" max="10" value="0" step="1" class="input-knob"
                                        id="vibRate">
                                    <span class="sliderval" id="range_slider__value2">Rate</span>
                                </div>
                            </div>

                        </div>
                        <div class="vert" style="border: 1px solid black; padding: 10px;">
                            <div class="hori">
                                <b>Distortion</b>
                                <input type="checkbox" class="input-switch" id="distortAct" onclick="distortAct()">
                            </div>
                            <div class="hori">
                                <div class="slidecontainer">
                                    <input type="range" min="0" max="10" value="0" step="1" class="input-knob"
                                        id="gain">
                                    <span class="sliderval" id="range_slider__value">Gain</span>
                                </div>
                                <div class="slidecontainer">
                                    <input type="range" min="0" max="10" value="10" step="1" class="input-knob"
                                        id="cutoff">
                                    <span class="sliderval" id="range_slider__value2">Cutoff</span>
                                </div>
                            </div>
                        </div>
                    </div>

                </div>

                <div class="ahdsr-container">
                    <div class="vert" style="border: 1px solid black; padding: 10px;">
                        <div class="hori">
                            <b>AHDSR</b>
                            <input type="checkbox" class="input-switch" id="ahdsrAct" onclick="ahdsrAct()">
                        </div>
                        <div class="hori">
                            <div class="vert">
                                <div class="slidecontainer">
                                    <input type="range" min="0" max="10" value="0" step="1" class="input-knob"
                                        id="attack">
                                </div>
                                <span>Attack</span>
                            </div>
                            <div class="vert">
                                <div class="slidecontainer">
                                    <input type="range" min="0" max="10" value="10" step="1" class="input-knob"
                                        id="hold">
                                </div>
                                <span>Hold</span>
                            </div>
                            <div class="vert">
                                <div class="slidecontainer">
                                    <input type="range" min="0" max="10" value="10" step="1" class="input-knob"
                                        id="decay">
                                </div>
                                <span>Decay</span>
                            </div>
                            <div class="vert">
                                <div class="slidecontainer">
                                    <input type="range" min="0" max="10" value="10" step="1" class="input-knob"
                                        id="sustain">
                                </div>
                                <span>Sustain</span>
                            </div>
                            <div class="vert">
                                <div class="slidecontainer">
                                    <input type="range" min="0" max="10" value="10" step="1" class="input-knob"
                                        id="release">
                                </div>
                                <span>Release</span>
                            </div>
                        </div>
                    </div>
                </div>

                <div class="oct-container" style="border: 1px solid black; padding: 10px;">
                    <div class="hori">
                        <div class="vert">
                            <div class="hori">
                                <div class="octBtnGroup">
                                    <button oct=-1 class="btn">Down</button>
                                    <button oct=1 class="btn">Up</button>
                                </div>
                                <div class="resetBtnGroup">
                                    <button oct=0 class="btn">Reset</button>
                                </div>
                            </div>
                            <span>Octave</span>
                        </div>
                        <div class="hori">
                            <div class="slidecontainer">
                                <input type="range" min="1" max="10" value="1" step="1" class="input-knob"
                                    id="Harmonics">
                                <span>Harmonics</span>
                            </div>
                            <div class="slidecontainer">
                                <input type="range" min="1" max="10" value="10" step="1" class="input-knob"
                                    id="volSlider">
                                <span>Volume</span>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div class="plot-container">
                <img src="assets/images/plot.png" id="plotimg">
            </div>
        </div>
        <div id="output"></div>

        <div class="piano-container">
            <ul class="piano-keys-list">
                <li class="piano-keys white-key" data-list="01">
                    <span>F<br>[A]</span>
                </li>
                <li class="piano-keys black-key" data-list="02">
                    <span>F#<br>[W]</span>
                </li>
                <li class="piano-keys white-key" data-list="03">
                    <span>G<br>[S]</span>
                </li>
                <li class="piano-keys black-key" data-list="04">
                    <span>G#<br>[E]</span>
                </li>
                <li class="piano-keys white-key" data-list="05">
                    <span>A<br>[D]</span>
                </li>
                <li class="piano-keys black-key" data-list="06">
                    <span>A#<br>[R]</span>
                </li>
                <li class="piano-keys white-key" data-list="07">
                    <span>B<br>[F]</span>
                </li>
                <li class="piano-keys white-key" data-list="08">
                    <span>C<br>[G]</span>
                </li>
                <li class="piano-keys black-key" data-list="09">
                    <span>C#<br>[Y]</span>
                </li>
                <li class="piano-keys white-key" data-list="10">
                    <span>D<br>[H]</span>
                </li>
                <li class="piano-keys black-key" data-list="11">
                    <span>D#<br>[U]</span>
                </li>
                <li class="piano-keys white-key" data-list="12">
                    <span>E<br>[J]</span>
                </li>
                <li class="piano-keys white-key" data-list="13">
                    <span>F<br>[K]</span>
                </li>
                <li class="piano-keys black-key" data-list="14">
                    <span>F#<br>[O]</span>
                </li>
                <li class="piano-keys white-key" data-list="15">
                    <span>G<br>[L]</span>
                </li>
                <li class="piano-keys black-key" data-list="16">
                    <span>G#<br>[P]</span>
                </li>
                <li class="piano-keys white-key" data-list="17">
                    <span>A<br>[J]</span>
                </li>
                <li class="piano-keys black-key" data-list="18">
                    <span>A#<br>[[]]</span>
                </li>
                <li class="piano-keys white-key" data-list="19">
                    <span>B<br>[']</span>
                </li>
                <li class="piano-keys white-key" data-list="20">
                    <span>C<br>[Ent]</span>
                </li>
                <li class="piano-keys black-key" data-list="21">
                    <span>C#<br>[7]</span>
                </li>
                <li class="piano-keys white-key" data-list="22">
                    <span>D<br>[4]</span>
                </li>
                <li class="piano-keys black-key" data-list="23">
                    <span>D#<br>[8]</span>
                </li>
                <li class="piano-keys white-key" data-list="24">
                    <span>E<br>[5]</span>
                </li>
            </ul>
        </div>
    </div>
    <script>
        const keys = document.querySelectorAll('.piano-keys');
        var plotImg = document.getElementById("plotimg");
        keys.forEach((key) => {
            key.addEventListener('click', (e) => {
                keyData = key.getAttribute('data-list');

                // Get the div element by its ID
                // const outputDiv = document.getElementById("output");
                k = keyData.toString();

                // Update the content of the div
                // outputDiv.innerHTML = keyData.toString();

                const xhr = new XMLHttpRequest();

                xhr.open("POST", "/piano");

                xhr.send(k);
                // plotImg.src = "assets/images/plot.png?" + new Date().getTime();
            })
        })

        document.addEventListener('keydown', function (event) {
            const xhr = new XMLHttpRequest();

            xhr.open("POST", "/pianoc");

            code = event.key;
            xhr.send(code);
            // plotImg.src = "assets/images/plot.png?" + new Date().getTime();
        });

        const buttons = document.querySelectorAll('.btn-group');

        buttons.forEach(button => {
            button.addEventListener('click', function (event) {
                const buttonNumber = event.target.getAttribute('data-number');
                const xhr = new XMLHttpRequest();
                xhr.open("POST", "/waveform");
                num = buttonNumber.toString();
                xhr.send(num)
            });
        });

        const octBtn = document.querySelectorAll('.octBtnGroup');

        octBtn.forEach(button => {
            button.addEventListener('click', function (event) {
                const buttonNumber = event.target.getAttribute('oct');
                const xhr = new XMLHttpRequest();
                xhr.open("POST", "/octaveShift");
                num = buttonNumber.toString();
                xhr.send(num)
            });
        });

        const resetBtn = document.querySelectorAll('.resetBtnGroup');

        resetBtn.forEach(button => {
            button.addEventListener('click', function (event) {
                const buttonNumber = event.target.getAttribute('oct');
                const xhr = new XMLHttpRequest();
                xhr.open("POST", "/octaveReset");
                num = buttonNumber.toString();
                xhr.send(num)
            });
        });

        var slider = document.getElementById("tremDepth");
        slider.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/tremoloDepth");
            num = this.value;
            xhr.send(num)
        }

        var slider2 = document.getElementById("vibDepth");
        slider2.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/vibratoDepth");
            num = this.value;
            xhr.send(num)
        }

        var slider3 = document.getElementById("vibRate");
        slider3.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/vibratoOF");
            num = this.value;
            xhr.send(num)
        }

        var slider3 = document.getElementById("tremRate");
        slider3.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/tremoloOF");
            num = this.value;
            xhr.send(num)
        }

        var VolumeSlider = document.getElementById("volSlider");
        VolumeSlider.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/volume");
            num = this.value;
            xhr.send(num)
        }

        var AttackSlider = document.getElementById("attack");
        AttackSlider.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/attack");
            num = this.value;
            xhr.send(num)
        }
        var HoldSlider = document.getElementById("hold");
        HoldSlider.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/hold");
            num = this.value;
            xhr.send(num)
        }
        var DecaySlider = document.getElementById("decay");
        DecaySlider.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/decay");
            num = this.value;
            xhr.send(num)
        }

        var SustainSlider = document.getElementById("sustain");
        SustainSlider.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/sustain");
            num = this.value;
            xhr.send(num)
        }

        var ReleaseSlider = document.getElementById("release");
        ReleaseSlider.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/release");
            num = this.value;
            xhr.send(num)
        }

        var HarmonicSlider = document.getElementById("Harmonics");
        HarmonicSlider.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/harmonics");
            num = this.value;
            xhr.send(num)
        }

        var gainSlider = document.getElementById("gain");
        gainSlider.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/gain");
            num = this.value;
            xhr.send(num)
        }

        var cutSlider = document.getElementById("cutoff");
        cutSlider.oninput = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/cutoff");
            num = this.value;
            xhr.send(num)
        }

        function ahdsrAct() {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/ahdsrAct");
            num = this.value;
            xhr.send(num);
        }

        function distortAct() {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/distortAct");
            num = this.value;
            xhr.send(num);
        }

        function vibAct() {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/vibAct");
            num = this.value;
            xhr.send(num);
        }

        function tremAct() {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/tremAct");
            num = this.value;
            xhr.send(num);
        }

        /* Toggle between adding and removing the "responsive" class to topnav when the user clicks on the icon */
        function myFunction() {
            var x = document.getElementById("myTopnav");
            if (x.className === "topnav") {
                x.className += " responsive";
            } else {
                x.className = "topnav";
            }
        }

        window.onload = function () {
            const xhr = new XMLHttpRequest();
            xhr.open("POST", "/resetVal");
            xhr.send(1)
            function updateImage() {
                document.getElementById("plotimg").src = document.getElementById("plotimg").src.split("?")[0] + "?" + new Date().getTime();
            }
            setInterval(updateImage, 0.1)
            // setTimeout("refreshBlock", 1);
        };

        // let handle = setInterval(() => {
        //     document.getElementById("plotimg").src= "assets/images/plot.png"
        // }, 10000);
    </script>
</body>

</html>